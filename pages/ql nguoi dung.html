<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n l√Ω ng∆∞·ªùi d√πng</title>
    <link rel="stylesheet" href="../css/pages/dashboard.css">
    <link rel="stylesheet" href="../css/components/header.css">
    <link rel="stylesheet" href="../css/components/sidebar.css">
    <link rel="stylesheet" href="../css/main.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar Toggle Button -->
        <button id="sidebar-toggle" class="sidebar-toggle-btn">
            <span id="sidebar-toggle-icon">‚ò∞</span>
        </button>
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header" style="white-space: nowrap; display: flex; align-items: center; gap: 8px;">
                <h2 style="white-space: nowrap; font-size: 22px; margin: 0;">Qu·∫£n l√≠ LAB</h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><span class="icon">üè†</span> <a href="trang chu.html" style="text-decoration:none; color:inherit;">Trang ch·ªß</a></li>
                    <li class="active"><span class="icon">üë§</span> <a href="ql nguoi dung.html" style="text-decoration:none; color:inherit;">Nh√¢n vi√™n</a></li>
                    <li><span class="icon">üñ•Ô∏è</span> <a href="trang ql thi·∫øt b·ªã.html" style="text-decoration:none; color:inherit;">Thi·∫øt b·ªã</a></li>
                    <li><span class="icon">üìÅ</span> <a href="ql du an.html" style="text-decoration:none; color:inherit;">D·ª± √°n</a></li>
                    <li><span class="icon">üîÑ</span> M∆∞·ª£n thi·∫øt b·ªã</li>
                </ul>
                <div class="sidebar-bottom">
                    <ul>
                        <li><span class="icon">‚öôÔ∏è</span> C√†i ƒë·∫∑t</li>
                        <li><span class="icon">üîì</span> ƒêƒÉng xu·∫•t</li>
                    </ul>
                </div>
            </nav>
        </aside>
        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left"></div>
                <div class="header-right">
                    <span class="icon">üîî</span>
                    <span class="user-info">
                        <img src="https://randomuser.me/api/portraits/women/68.jpg" alt="avatar" class="avatar">
                        <span>Ki√™n </span>
                        <span class="role">Admin</span>
                    </span>
                </div>
            </header>
            <!-- User Management Content -->
            <section class="dashboard">
                <h1>Qu·∫£n l√Ω ng∆∞·ªùi d√πng</h1>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 18px;">
                    <h2 style="margin: 0;">Danh s√°ch ng∆∞·ªùi d√πng</h2>
                    <button class="btn-detail" id="btn-add-user">+ Th√™m ng∆∞·ªùi d√πng</button>
                </div>
                <table class="project-table" id="user-table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>H·ªç t√™n</th>
                            <th>Email</th>
                            <th>Vai tr√≤</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>H√†nh ƒë·ªông</th>
                        </tr>
                    </thead>
                    <tbody id="user-table-body">
                        <!-- D·ªØ li·ªáu m·∫´u -->
                        <tr>
                            <td>1</td>
                            <td>Nguy·ªÖn VƒÉn A</td>
                            <td>vana@gmail.com</td>
                            <td>Admin</td>
                            <td><span class="status-done">Ho·∫°t ƒë·ªông</span></td>
                            <td>
                                <button class="btn-detail btn-edit">S·ª≠a</button>
                                <button class="btn-detail btn-delete" style="background:#e74c3c;">Xo√°</button>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Tr·∫ßn Th·ªã B</td>
                            <td>thib@gmail.com</td>
                            <td>Nh√¢n vi√™n</td>
                            <td><span class="status-done" style="background:#f1c40f; color:#fff;">T·∫°m kho√°</span></td>
                            <td>
                                <button class="btn-detail btn-edit">S·ª≠a</button>
                                <button class="btn-detail btn-delete" style="background:#e74c3c;">Xo√°</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <!-- Pagination Footer -->
                <div id="pagination-footer" style="display:flex; align-items:center; justify-content:space-between; margin-top:12px;">
                    <div id="page-info" style="font-weight:500;">Trang 1/1</div>
                    <div>
                        <button id="btn-prev-page" class="btn-detail" style="min-width:36px; padding:4px 0;">&lt;</button>
                        <button id="btn-next-page" class="btn-detail" style="min-width:36px; padding:4px 0;">&gt;</button>
                    </div>
                </div>
            </section>
            <!-- Modal Th√™m/S·ª≠a ng∆∞·ªùi d√πng (·∫©n/hi·ªán b·∫±ng JS) -->
            <div id="user-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.2); align-items:center; justify-content:center; z-index:2000;">
                <form id="user-form" style="background:#fff; padding:32px 24px; border-radius:12px; min-width:320px; max-width:90vw; box-shadow:0 2px 16px rgba(0,0,0,0.12); display:flex; flex-direction:column; gap:16px;">
                    <h3 id="modal-title">Th√™m ng∆∞·ªùi d√πng</h3>
                    <input type="text" id="user-name" placeholder="H·ªç t√™n" required>
                    <input type="email" id="user-email" placeholder="Email" required>
                    <select id="user-role">
                        <option value="Admin">Admin</option>
                        <option value="Nh√¢n vi√™n">Nh√¢n vi√™n</option>
                    </select>
                    <select id="user-status">
                        <option value="Ho·∫°t ƒë·ªông">Ho·∫°t ƒë·ªông</option>
                        <option value="T·∫°m kho√°">T·∫°m kho√°</option>
                    </select>
                    <div style="display:flex; gap:12px; justify-content:flex-end;">
                        <button type="button" class="btn-detail" id="btn-cancel" style="background:#aaa;">Hu·ª∑</button>
                        <button type="submit" class="btn-detail" id="btn-save">L∆∞u</button>
                    </div>
                </form>
            </div>
        </main>
    </div>
    <script>
    // Sidebar toggle logic
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebar-toggle');
    sidebarToggle.addEventListener('click', function() {
        sidebar.classList.toggle('sidebar-closed');
        if (sidebar.classList.contains('sidebar-closed')) {
            sidebar.style.marginLeft = '-250px';
        } else {
            sidebar.style.marginLeft = '0';
        }
    });

    // User CRUD logic
    const userModal = document.getElementById('user-modal');
    const btnAddUser = document.getElementById('btn-add-user');
    const btnCancel = document.getElementById('btn-cancel');
    const userForm = document.getElementById('user-form');
    const userTableBody = document.getElementById('user-table-body');
    let editRow = null;

    // --- Pagination Logic ---
    const USERS_PER_PAGE = 10;
    let users = [
        { name: 'Nguy·ªÖn VƒÉn A', email: 'vana@gmail.com', role: 'Admin', status: 'Ho·∫°t ƒë·ªông' },
        { name: 'Tr·∫ßn Th·ªã B', email: 'thib@gmail.com', role: 'Nh√¢n vi√™n', status: 'T·∫°m kho√°' },
        { name: 'L√™ VƒÉn C', email: 'c@gmail.com', role: 'Nh√¢n vi√™n', status: 'Ho·∫°t ƒë·ªông' },
        { name: 'Ph·∫°m Th·ªã D', email: 'd@gmail.com', role: 'Nh√¢n vi√™n', status: 'Ho·∫°t ƒë·ªông' },
        { name: 'Ng√¥ VƒÉn E', email: 'e@gmail.com', role: 'Admin', status: 'T·∫°m kho√°' },
        { name: 'ƒê·ªó Th·ªã F', email: 'f@gmail.com', role: 'Nh√¢n vi√™n', status: 'Ho·∫°t ƒë·ªông' },
        { name: 'B√πi VƒÉn G', email: 'g@gmail.com', role: 'Nh√¢n vi√™n', status: 'Ho·∫°t ƒë·ªông' },
        // ...c√≥ th·ªÉ th√™m nhi·ªÅu ng∆∞·ªùi d√πng m·∫´u ƒë·ªÉ test ph√¢n trang...
    ];
    let currentPage = 1;

    function renderUserTable() {
        const start = (currentPage - 1) * USERS_PER_PAGE;
        const end = start + USERS_PER_PAGE;
        const pageUsers = users.slice(start, end);
        userTableBody.innerHTML = '';
        pageUsers.forEach((user, idx) => {
            const stt = start + idx + 1;
            const statusHtml = user.status === 'Ho·∫°t ƒë·ªông'
                ? '<span class="status-done">Ho·∫°t ƒë·ªông</span>'
                : '<span class="status-done" style="background:#f1c40f; color:#fff;">T·∫°m kho√°</span>';
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${stt}</td><td>${user.name}</td><td>${user.email}</td><td>${user.role}</td><td>${statusHtml}</td><td><button class="btn-detail btn-edit">S·ª≠a</button> <button class="btn-detail btn-delete" style="background:#e74c3c;">Xo√°</button></td>`;
            userTableBody.appendChild(tr);
        });
        updatePaginationInfo();
    }

    function updatePaginationInfo() {
        const totalPages = Math.ceil(users.length / USERS_PER_PAGE) || 1;
        document.getElementById('page-info').innerText = `Trang ${currentPage}/${totalPages}`;
        document.getElementById('btn-prev-page').disabled = currentPage === 1;
        document.getElementById('btn-next-page').disabled = currentPage === totalPages;
    }

    document.getElementById('btn-prev-page').onclick = function() {
        if (currentPage > 1) {
            currentPage--;
            renderUserTable();
        }
    };
    document.getElementById('btn-next-page').onclick = function() {
        const totalPages = Math.ceil(users.length / USERS_PER_PAGE) || 1;
        if (currentPage < totalPages) {
            currentPage++;
            renderUserTable();
        }
    };

    // --- Override CRUD logic to update users array and re-render table ---
    btnAddUser.onclick = function() {
        userForm.reset();
        document.getElementById('modal-title').innerText = 'Th√™m ng∆∞·ªùi d√πng';
        userModal.style.display = 'flex';
        editRow = null;
    };
    btnCancel.onclick = function() {
        userModal.style.display = 'none';
    };
    userTableBody.onclick = function(e) {
        if (e.target.classList.contains('btn-edit')) {
            const rowIdx = e.target.closest('tr').rowIndex - 1;
            const userIdx = (currentPage - 1) * USERS_PER_PAGE + rowIdx;
            editRow = userIdx;
            document.getElementById('modal-title').innerText = 'S·ª≠a ng∆∞·ªùi d√πng';
            document.getElementById('user-name').value = users[userIdx].name;
            document.getElementById('user-email').value = users[userIdx].email;
            document.getElementById('user-role').value = users[userIdx].role;
            document.getElementById('user-status').value = users[userIdx].status;
            userModal.style.display = 'flex';
        }
        if (e.target.classList.contains('btn-delete')) {
            const rowIdx = e.target.closest('tr').rowIndex - 1;
            const userIdx = (currentPage - 1) * USERS_PER_PAGE + rowIdx;
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën xo√° ng∆∞·ªùi d√πng n√†y?')) {
                users.splice(userIdx, 1);
                // N·∫øu xo√° h·∫øt trang hi·ªán t·∫°i th√¨ l√πi v·ªÅ trang tr∆∞·ªõc
                const totalPages = Math.ceil(users.length / USERS_PER_PAGE) || 1;
                if (currentPage > totalPages) currentPage = totalPages;
                renderUserTable();
            }
        }
    };
    userForm.onsubmit = function(e) {
        e.preventDefault();
        const name = document.getElementById('user-name').value;
        const email = document.getElementById('user-email').value;
        const role = document.getElementById('user-role').value;
        const status = document.getElementById('user-status').value;
        if (editRow !== null) {
            users[editRow] = { name, email, role, status };
        } else {
            users.push({ name, email, role, status });
            // N·∫øu th√™m v√†o trang m·ªõi th√¨ chuy·ªÉn sang trang ƒë√≥
            const totalPages = Math.ceil(users.length / USERS_PER_PAGE) || 1;
            currentPage = totalPages;
        }
        userModal.style.display = 'none';
        renderUserTable();
    };
    userModal.onclick = function(e) {
        if (e.target === userModal) userModal.style.display = 'none';
    };
    // Kh·ªüi t·∫°o b·∫£ng l·∫ßn ƒë·∫ßu
    renderUserTable();
    </script>
</body>
</html>
